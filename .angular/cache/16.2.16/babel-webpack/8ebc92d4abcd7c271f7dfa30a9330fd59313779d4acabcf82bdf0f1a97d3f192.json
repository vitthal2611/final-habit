{"ast":null,"code":"import _asyncToGenerator from \"c:/Users/Amruta Raut/final-habit/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { signal } from '@angular/core';\nimport { initializeApp } from 'firebase/app';\nimport { getDatabase, ref, set, onValue, get } from 'firebase/database';\nimport { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from 'firebase/auth';\nimport * as i0 from \"@angular/core\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyCcGMIKGZlWqvOUM1-mjFHIIT-WvKktl_0\",\n  authDomain: \"habit-tracker-86281.firebaseapp.com\",\n  databaseURL: \"https://habit-tracker-86281.firebaseio.com/\",\n  projectId: \"habit-tracker-86281\",\n  storageBucket: \"habit-tracker-86281.firebasestorage.app\",\n  messagingSenderId: \"325420672462\",\n  appId: \"1:325420672462:web:8df0ee22fe8b496356779f\"\n};\nconst app = initializeApp(firebaseConfig);\nconst database = getDatabase(app);\nconst auth = getAuth(app);\nexport let FirebaseService = /*#__PURE__*/(() => {\n  class FirebaseService {\n    constructor() {\n      this.currentUser = signal(null);\n      onAuthStateChanged(auth, user => {\n        this.currentUser.set(user);\n      });\n    }\n    signInWithGoogle() {\n      return _asyncToGenerator(function* () {\n        const provider = new GoogleAuthProvider();\n        yield signInWithPopup(auth, provider);\n      })();\n    }\n    signOut() {\n      return _asyncToGenerator(function* () {\n        yield signOut(auth);\n      })();\n    }\n    getUserPath(path) {\n      const uid = this.currentUser()?.uid;\n      if (!uid) throw new Error('User not authenticated');\n      return `users/${uid}/${path}`;\n    }\n    saveHabits(habits) {\n      const habitsRef = ref(database, this.getUserPath('habits'));\n      const cleanHabits = JSON.parse(JSON.stringify(habits));\n      set(habitsRef, cleanHabits);\n    }\n    saveLogs(logs) {\n      const logsRef = ref(database, this.getUserPath('logs'));\n      const cleanLogs = logs.map(log => ({\n        habitId: log.habitId,\n        date: log.date,\n        completed: log.completed,\n        ...(log.note && {\n          note: log.note\n        }),\n        ...(log.milestoneCount && {\n          milestoneCount: log.milestoneCount\n        })\n      }));\n      set(logsRef, cleanLogs);\n    }\n    getHabits() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const habitsRef = ref(database, _this.getUserPath('habits'));\n        const snapshot = yield get(habitsRef);\n        return snapshot.exists() ? snapshot.val() : [];\n      })();\n    }\n    getLogs() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        const logsRef = ref(database, _this2.getUserPath('logs'));\n        const snapshot = yield get(logsRef);\n        return snapshot.exists() ? snapshot.val() : [];\n      })();\n    }\n    onHabitsChange(callback) {\n      if (!this.currentUser()) return;\n      const habitsRef = ref(database, this.getUserPath('habits'));\n      onValue(habitsRef, snapshot => {\n        callback(snapshot.exists() ? snapshot.val() : []);\n      });\n    }\n    onLogsChange(callback) {\n      if (!this.currentUser()) return;\n      const logsRef = ref(database, this.getUserPath('logs'));\n      onValue(logsRef, snapshot => {\n        callback(snapshot.exists() ? snapshot.val() : []);\n      });\n    }\n    saveReflection(date, reflection) {\n      const reflectionRef = ref(database, this.getUserPath(`reflections/${date}`));\n      set(reflectionRef, reflection);\n    }\n    getReflections() {\n      var _this3 = this;\n      return _asyncToGenerator(function* () {\n        const reflectionsRef = ref(database, _this3.getUserPath('reflections'));\n        const snapshot = yield get(reflectionsRef);\n        if (!snapshot.exists()) return [];\n        const data = snapshot.val();\n        return Object.keys(data).map(date => ({\n          date,\n          ...data[date]\n        }));\n      })();\n    }\n    static {\n      this.ɵfac = function FirebaseService_Factory(t) {\n        return new (t || FirebaseService)();\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: FirebaseService,\n        factory: FirebaseService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return FirebaseService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}