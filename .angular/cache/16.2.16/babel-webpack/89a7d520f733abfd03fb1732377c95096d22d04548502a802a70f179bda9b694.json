{"ast":null,"code":"import { computed } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { HabitService } from '../../core/services/habit.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../core/services/habit.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction WeeklyReflectionComponent_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"div\", 13)(2, \"div\", 14);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 15);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 16);\n    i0.ɵɵelement(7, \"div\", 17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\", 18);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const habit_r1 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(habit_r1.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r0.getHabitWeeklyVotes(habit_r1.id), \"/7\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵstyleProp(\"width\", ctx_r0.getHabitWeeklyVotes(habit_r1.id) / 7 * 100, \"%\")(\"background\", habit_r1.color);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(habit_r1.identity);\n  }\n}\nexport let WeeklyReflectionComponent = /*#__PURE__*/(() => {\n  class WeeklyReflectionComponent {\n    constructor(habitService) {\n      this.habitService = habitService;\n      this.habits = computed(() => this.habitService.allHabits());\n      this.reflection = {\n        whatHelped: '',\n        obstacles: '',\n        adjustments: ''\n      };\n    }\n    totalVotes() {\n      return this.habits().reduce((sum, habit) => {\n        return sum + this.getHabitWeeklyVotes(habit.id);\n      }, 0);\n    }\n    consistencyRate() {\n      const total = this.habits().length * 7;\n      if (total === 0) return 0;\n      return Math.round(this.totalVotes() / total * 100);\n    }\n    bestStreak() {\n      let maxStreak = 0;\n      this.habits().forEach(habit => {\n        const streak = this.getHabitWeeklyVotes(habit.id);\n        if (streak > maxStreak) maxStreak = streak;\n      });\n      return maxStreak;\n    }\n    getHabitWeeklyVotes(habitId) {\n      let count = 0;\n      for (let i = 0; i < 7; i++) {\n        const date = new Date();\n        date.setDate(date.getDate() - i);\n        const dateStr = date.toISOString().split('T')[0];\n        if (this.habitService.getHabitState(habitId, dateStr) === 'done') {\n          count++;\n        }\n      }\n      return count;\n    }\n    saveReflection() {\n      const weekKey = this.getWeekKey();\n      localStorage.setItem(`reflection-${weekKey}`, JSON.stringify(this.reflection));\n      alert('Reflection saved!');\n    }\n    getWeekKey() {\n      const date = new Date();\n      const year = date.getFullYear();\n      const week = Math.ceil((date.getDate() + new Date(year, 0, 1).getDay()) / 7);\n      return `${year}-W${week}`;\n    }\n    static {\n      this.ɵfac = function WeeklyReflectionComponent_Factory(t) {\n        return new (t || WeeklyReflectionComponent)(i0.ɵɵdirectiveInject(i1.HabitService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: WeeklyReflectionComponent,\n        selectors: [[\"app-weekly-reflection\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 43,\n        vars: 7,\n        consts: [[1, \"reflection\"], [1, \"subtitle\"], [1, \"week-summary\"], [1, \"stat-card\"], [1, \"stat-value\"], [1, \"stat-label\"], [1, \"habits-review\"], [\"class\", \"habit-review-card\", 4, \"ngFor\", \"ngForOf\"], [1, \"reflection-questions\"], [1, \"question-card\"], [\"rows\", \"3\", \"placeholder\", \"Write your thoughts...\", 3, \"ngModel\", \"ngModelChange\"], [1, \"save-btn\", 3, \"click\"], [1, \"habit-review-card\"], [1, \"habit-header\"], [1, \"habit-name\"], [1, \"habit-score\"], [1, \"progress-bar\"], [1, \"progress-fill\"], [1, \"habit-identity\"]],\n        template: function WeeklyReflectionComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"header\")(2, \"h1\");\n            i0.ɵɵtext(3, \"Weekly Reflection\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"p\", 1);\n            i0.ɵɵtext(5, \"Review your habits from the past week\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(6, \"div\", 2)(7, \"div\", 3)(8, \"div\", 4);\n            i0.ɵɵtext(9);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(10, \"div\", 5);\n            i0.ɵɵtext(11, \"Total Votes\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(12, \"div\", 3)(13, \"div\", 4);\n            i0.ɵɵtext(14);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(15, \"div\", 5);\n            i0.ɵɵtext(16, \"Consistency\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(17, \"div\", 3)(18, \"div\", 4);\n            i0.ɵɵtext(19);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(20, \"div\", 5);\n            i0.ɵɵtext(21, \"Best Streak\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(22, \"div\", 6)(23, \"h2\");\n            i0.ɵɵtext(24, \"Habit Performance\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(25, WeeklyReflectionComponent_div_25_Template, 10, 7, \"div\", 7);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(26, \"div\", 8)(27, \"h2\");\n            i0.ɵɵtext(28, \"Reflection Questions\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(29, \"div\", 9)(30, \"label\");\n            i0.ɵɵtext(31, \"What helped you show up this week?\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(32, \"textarea\", 10);\n            i0.ɵɵlistener(\"ngModelChange\", function WeeklyReflectionComponent_Template_textarea_ngModelChange_32_listener($event) {\n              return ctx.reflection.whatHelped = $event;\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(33, \"div\", 9)(34, \"label\");\n            i0.ɵɵtext(35, \"What obstacles did you face?\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(36, \"textarea\", 10);\n            i0.ɵɵlistener(\"ngModelChange\", function WeeklyReflectionComponent_Template_textarea_ngModelChange_36_listener($event) {\n              return ctx.reflection.obstacles = $event;\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(37, \"div\", 9)(38, \"label\");\n            i0.ɵɵtext(39, \"What will you adjust next week?\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(40, \"textarea\", 10);\n            i0.ɵɵlistener(\"ngModelChange\", function WeeklyReflectionComponent_Template_textarea_ngModelChange_40_listener($event) {\n              return ctx.reflection.adjustments = $event;\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(41, \"button\", 11);\n            i0.ɵɵlistener(\"click\", function WeeklyReflectionComponent_Template_button_click_41_listener() {\n              return ctx.saveReflection();\n            });\n            i0.ɵɵtext(42, \"Save Reflection\");\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(9);\n            i0.ɵɵtextInterpolate(ctx.totalVotes());\n            i0.ɵɵadvance(5);\n            i0.ɵɵtextInterpolate1(\"\", ctx.consistencyRate(), \"%\");\n            i0.ɵɵadvance(5);\n            i0.ɵɵtextInterpolate(ctx.bestStreak());\n            i0.ɵɵadvance(6);\n            i0.ɵɵproperty(\"ngForOf\", ctx.habits());\n            i0.ɵɵadvance(7);\n            i0.ɵɵproperty(\"ngModel\", ctx.reflection.whatHelped);\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"ngModel\", ctx.reflection.obstacles);\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"ngModel\", ctx.reflection.adjustments);\n          }\n        },\n        dependencies: [CommonModule, i2.NgForOf, FormsModule, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel],\n        styles: [\".reflection[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px}header[_ngcontent-%COMP%]{margin-bottom:32px}h1[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#111827;margin:0 0 4px}h2[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#111827;margin:0 0 16px}.subtitle[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;margin:0}.week-summary[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-bottom:32px}.stat-card[_ngcontent-%COMP%]{background:white;padding:24px;border-radius:12px;box-shadow:0 2px 8px #00000014;text-align:center}.stat-value[_ngcontent-%COMP%]{font-size:32px;font-weight:700;color:#6366f1;margin-bottom:8px}.stat-label[_ngcontent-%COMP%]{font-size:14px;color:#6b7280}.habits-review[_ngcontent-%COMP%]{background:white;padding:24px;border-radius:12px;box-shadow:0 2px 8px #00000014;margin-bottom:32px}.habit-review-card[_ngcontent-%COMP%]{padding:16px;background:#f9fafb;border-radius:8px;margin-bottom:12px}.habit-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.habit-name[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#111827}.habit-score[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#6366f1}.progress-bar[_ngcontent-%COMP%]{height:8px;background:#e5e7eb;border-radius:4px;overflow:hidden;margin-bottom:8px}.progress-fill[_ngcontent-%COMP%]{height:100%;transition:width .3s}.habit-identity[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-style:italic}.reflection-questions[_ngcontent-%COMP%]{background:white;padding:24px;border-radius:12px;box-shadow:0 2px 8px #00000014}.question-card[_ngcontent-%COMP%]{margin-bottom:24px}label[_ngcontent-%COMP%]{display:block;font-size:15px;font-weight:600;color:#374151;margin-bottom:8px}textarea[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid #d1d5db;border-radius:8px;font-size:14px;font-family:inherit;resize:vertical}textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#6366f1}.save-btn[_ngcontent-%COMP%]{width:100%;padding:14px;background:#6366f1;color:#fff;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer}.save-btn[_ngcontent-%COMP%]:hover{background:#4f46e5}@media (max-width: 640px){.week-summary[_ngcontent-%COMP%]{grid-template-columns:1fr}}\"]\n      });\n    }\n  }\n  return WeeklyReflectionComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}