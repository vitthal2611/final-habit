{"ast":null,"code":"import { computed, signal } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { HabitService } from '../../core/services/habit.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../core/services/habit.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction ReportComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"input\", 14);\n    i0.ɵɵlistener(\"ngModelChange\", function ReportComponent_div_16_Template_input_ngModelChange_1_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.startDate = $event);\n    })(\"change\", function ReportComponent_div_16_Template_input_change_1_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.updateReport());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"input\", 14);\n    i0.ɵɵlistener(\"ngModelChange\", function ReportComponent_div_16_Template_input_ngModelChange_2_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.endDate = $event);\n    })(\"change\", function ReportComponent_div_16_Template_input_change_2_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.updateReport());\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.startDate);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.endDate);\n  }\n}\nfunction ReportComponent_th_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const habit_r9 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(habit_r9.name);\n  }\n}\nfunction ReportComponent_tr_27_td_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 17)(1, \"span\", 18);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const habit_r12 = ctx.$implicit;\n    const day_r10 = i0.ɵɵnextContext().$implicit;\n    const ctx_r11 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassProp(\"voted\", ctx_r11.hasVote(habit_r12.id, day_r10.dateStr));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r11.hasVote(habit_r12.id, day_r10.dateStr) ? \"\\u2713\" : \"-\", \" \");\n  }\n}\nfunction ReportComponent_tr_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 15);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, ReportComponent_tr_27_td_4_Template, 3, 3, \"td\", 16);\n    i0.ɵɵelementStart(5, \"td\", 12);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const day_r10 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(3, 3, day_r10.date, \"MMM d, y\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.habits());\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.getDayTotal(day_r10.dateStr));\n  }\n}\nfunction ReportComponent_td_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 12)(1, \"strong\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const habit_r14 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r3.getHabitTotal(habit_r14.id));\n  }\n}\nexport let ReportComponent = /*#__PURE__*/(() => {\n  class ReportComponent {\n    constructor(habitService) {\n      this.habitService = habitService;\n      this.habits = computed(() => {\n        return this.habitService.allHabits().sort((a, b) => {\n          return a.time.localeCompare(b.time);\n        });\n      });\n      this.filterType = 'month';\n      this.startDate = '';\n      this.endDate = '';\n      this.reportDays = signal([]);\n      this.updateReport();\n    }\n    updateReport() {\n      const days = [];\n      let start;\n      let end = new Date();\n      if (this.filterType === '30days') {\n        start = new Date();\n        start.setDate(start.getDate() - 29);\n      } else if (this.filterType === 'month') {\n        start = new Date(end.getFullYear(), end.getMonth(), 1);\n      } else if (this.filterType === 'year') {\n        start = new Date(end.getFullYear(), 0, 1);\n      } else if (this.filterType === 'custom' && this.startDate && this.endDate) {\n        start = new Date(this.startDate);\n        end = new Date(this.endDate);\n      } else {\n        start = new Date();\n        start.setDate(start.getDate() - 29);\n      }\n      const current = new Date(start);\n      while (current <= end) {\n        days.push({\n          date: new Date(current),\n          dateStr: current.toISOString().split('T')[0]\n        });\n        current.setDate(current.getDate() + 1);\n      }\n      this.reportDays.set(days.reverse());\n    }\n    hasVote(habitId, date) {\n      return this.habitService.getHabitState(habitId, date) === 'done';\n    }\n    getDayTotal(date) {\n      return this.habits().filter(h => this.hasVote(h.id, date)).length;\n    }\n    getHabitTotal(habitId) {\n      return this.habitService.allLogs().filter(l => l.habitId === habitId && l.completed).length;\n    }\n    getGrandTotal() {\n      return this.habitService.allLogs().filter(l => l.completed).length;\n    }\n    static {\n      this.ɵfac = function ReportComponent_Factory(t) {\n        return new (t || ReportComponent)(i0.ɵɵdirectiveInject(i1.HabitService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: ReportComponent,\n        selectors: [[\"app-report\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 37,\n        vars: 6,\n        consts: [[1, \"report\"], [1, \"subtitle\"], [1, \"filters\"], [3, \"ngModel\", \"ngModelChange\", \"change\"], [\"value\", \"30days\"], [\"value\", \"month\"], [\"value\", \"year\"], [\"value\", \"custom\"], [\"class\", \"date-inputs\", 4, \"ngIf\"], [1, \"report-table\"], [4, \"ngFor\", \"ngForOf\"], [\"class\", \"total-cell\", 4, \"ngFor\", \"ngForOf\"], [1, \"total-cell\"], [1, \"date-inputs\"], [\"type\", \"date\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [1, \"date-cell\"], [\"class\", \"vote-cell\", 4, \"ngFor\", \"ngForOf\"], [1, \"vote-cell\"], [1, \"vote\"]],\n        template: function ReportComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"header\")(2, \"h1\");\n            i0.ɵɵtext(3, \"Habit Report\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"p\", 1);\n            i0.ɵɵtext(5, \"Day-wise votes for all habits\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(6, \"div\", 2)(7, \"select\", 3);\n            i0.ɵɵlistener(\"ngModelChange\", function ReportComponent_Template_select_ngModelChange_7_listener($event) {\n              return ctx.filterType = $event;\n            })(\"change\", function ReportComponent_Template_select_change_7_listener() {\n              return ctx.updateReport();\n            });\n            i0.ɵɵelementStart(8, \"option\", 4);\n            i0.ɵɵtext(9, \"Last 30 Days\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(10, \"option\", 5);\n            i0.ɵɵtext(11, \"This Month\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(12, \"option\", 6);\n            i0.ɵɵtext(13, \"This Year\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(14, \"option\", 7);\n            i0.ɵɵtext(15, \"Custom Range\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(16, ReportComponent_div_16_Template, 3, 2, \"div\", 8);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(17, \"div\", 9)(18, \"table\")(19, \"thead\")(20, \"tr\")(21, \"th\");\n            i0.ɵɵtext(22, \"Date\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(23, ReportComponent_th_23_Template, 2, 1, \"th\", 10);\n            i0.ɵɵelementStart(24, \"th\");\n            i0.ɵɵtext(25, \"Total\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(26, \"tbody\");\n            i0.ɵɵtemplate(27, ReportComponent_tr_27_Template, 7, 6, \"tr\", 10);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(28, \"tfoot\")(29, \"tr\")(30, \"td\")(31, \"strong\");\n            i0.ɵɵtext(32, \"Total\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(33, ReportComponent_td_33_Template, 3, 1, \"td\", 11);\n            i0.ɵɵelementStart(34, \"td\", 12)(35, \"strong\");\n            i0.ɵɵtext(36);\n            i0.ɵɵelementEnd()()()()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(7);\n            i0.ɵɵproperty(\"ngModel\", ctx.filterType);\n            i0.ɵɵadvance(9);\n            i0.ɵɵproperty(\"ngIf\", ctx.filterType === \"custom\");\n            i0.ɵɵadvance(7);\n            i0.ɵɵproperty(\"ngForOf\", ctx.habits());\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"ngForOf\", ctx.reportDays());\n            i0.ɵɵadvance(6);\n            i0.ɵɵproperty(\"ngForOf\", ctx.habits());\n            i0.ɵɵadvance(3);\n            i0.ɵɵtextInterpolate(ctx.getGrandTotal());\n          }\n        },\n        dependencies: [CommonModule, i2.NgForOf, i2.NgIf, i2.DatePipe, FormsModule, i3.NgSelectOption, i3.ɵNgSelectMultipleOption, i3.DefaultValueAccessor, i3.SelectControlValueAccessor, i3.NgControlStatus, i3.NgModel],\n        styles: [\".report[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:20px}header[_ngcontent-%COMP%]{margin-bottom:24px}h1[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#111827;margin:0 0 4px}.subtitle[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;margin:0}.filters[_ngcontent-%COMP%]{display:flex;gap:12px;margin-bottom:20px;align-items:center}.filters[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .date-inputs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:14px}.date-inputs[_ngcontent-%COMP%]{display:flex;gap:8px}.report-table[_ngcontent-%COMP%]{background:white;border-radius:12px;padding:20px;box-shadow:0 2px 8px #00000014;overflow-x:auto}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}th[_ngcontent-%COMP%]{padding:12px;text-align:left;font-size:12px;font-weight:700;color:#6b7280;text-transform:uppercase;border-bottom:2px solid #e5e7eb}td[_ngcontent-%COMP%]{padding:12px;border-bottom:1px solid #f3f4f6}.date-cell[_ngcontent-%COMP%]{font-weight:600;color:#374151}.vote-cell[_ngcontent-%COMP%]{text-align:center}.vote[_ngcontent-%COMP%]{display:inline-block;width:24px;height:24px;line-height:24px;text-align:center;border-radius:4px;color:#9ca3af}.vote.voted[_ngcontent-%COMP%]{background:#10b981;color:#fff;font-weight:700}.total-cell[_ngcontent-%COMP%]{text-align:center;font-weight:600;color:#6366f1}tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:2px solid #e5e7eb;border-bottom:none;padding-top:16px}\"]\n      });\n    }\n  }\n  return ReportComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}