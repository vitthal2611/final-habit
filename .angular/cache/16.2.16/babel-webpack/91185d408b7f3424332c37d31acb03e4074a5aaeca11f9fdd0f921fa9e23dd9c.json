{"ast":null,"code":"import { signal } from '@angular/core';\nimport { FirebaseService } from './firebase.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./firebase.service\";\nexport let HabitService = /*#__PURE__*/(() => {\n  class HabitService {\n    constructor(firebase) {\n      this.firebase = firebase;\n      this.habits = signal([]);\n      this.logs = signal([]);\n      this.allHabits = this.habits.asReadonly();\n      this.allLogs = this.logs.asReadonly();\n      this.firebase.onHabitsChange(habits => this.habits.set(habits));\n      this.firebase.onLogsChange(logs => this.logs.set(logs));\n      this.createSampleHabit();\n    }\n    createSampleHabit() {\n      const sampleHabits = [{\n        id: 'sample-1',\n        name: 'Drink a glass of water',\n        identity: 'a healthy person',\n        trigger: {\n          when: 'After I wake up',\n          where: 'In the kitchen'\n        },\n        time: '07:00',\n        cue: 'Water bottle on counter',\n        reward: '',\n        twoMinuteRule: 'Just fill the glass',\n        frequency: 'daily',\n        color: '#10b981',\n        createdAt: new Date(),\n        difficulty: 'tiny'\n      }, {\n        id: 'sample-2',\n        name: 'Read 2 pages',\n        identity: 'a reader',\n        trigger: {\n          when: 'Before bed',\n          where: 'In bedroom'\n        },\n        time: '22:00',\n        cue: 'Book on nightstand',\n        reward: '',\n        twoMinuteRule: 'Just read one paragraph',\n        frequency: 'daily',\n        color: '#6366f1',\n        createdAt: new Date(),\n        difficulty: 'tiny'\n      }, {\n        id: 'sample-3',\n        name: 'Do 5 pushups',\n        identity: 'an athlete',\n        trigger: {\n          when: 'After breakfast',\n          where: 'In living room'\n        },\n        time: '08:30',\n        cue: 'Yoga mat on floor',\n        reward: '',\n        twoMinuteRule: 'Just do one pushup',\n        frequency: 'daily',\n        color: '#f59e0b',\n        createdAt: new Date(),\n        difficulty: 'tiny'\n      }, {\n        id: 'sample-4',\n        name: 'Meditate for 2 minutes',\n        identity: 'a mindful person',\n        trigger: {\n          when: 'After lunch',\n          where: 'At my desk'\n        },\n        time: '13:00',\n        cue: 'Meditation app open',\n        reward: '',\n        twoMinuteRule: 'Just take 3 deep breaths',\n        frequency: 'daily',\n        color: '#8b5cf6',\n        createdAt: new Date(),\n        difficulty: 'tiny'\n      }, {\n        id: 'sample-5',\n        name: 'Write one sentence in journal',\n        identity: 'a reflective person',\n        trigger: {\n          when: 'After dinner',\n          where: 'At dining table'\n        },\n        time: '19:30',\n        cue: 'Journal next to laptop',\n        reward: '',\n        twoMinuteRule: 'Just write one word',\n        frequency: 'daily',\n        color: '#ec4899',\n        createdAt: new Date(),\n        difficulty: 'tiny'\n      }, {\n        id: 'sample-6',\n        name: 'Stretch for 1 minute',\n        identity: 'a flexible person',\n        trigger: {\n          when: 'After work',\n          where: 'In home office'\n        },\n        time: '17:00',\n        cue: 'Standing desk reminder',\n        reward: '',\n        twoMinuteRule: 'Just reach for the ceiling',\n        frequency: 'daily',\n        color: '#06b6d4',\n        createdAt: new Date(),\n        difficulty: 'tiny'\n      }];\n      this.habits.set(sampleHabits);\n    }\n    addHabit(habit) {\n      const updated = [...this.habits(), habit];\n      this.habits.set(updated);\n      this.firebase.saveHabits(updated);\n    }\n    logHabit(habitId, date, completed, note, milestoneCount) {\n      const logs = this.logs().filter(l => !(l.habitId === habitId && l.date === date));\n      const updated = [...logs, {\n        habitId,\n        date,\n        completed,\n        note,\n        milestoneCount\n      }];\n      this.logs.set(updated);\n      this.firebase.saveLogs(updated);\n    }\n    getHabitState(habitId, date) {\n      const log = this.logs().find(l => l.habitId === habitId && l.date === date);\n      if (!log) return 'pending';\n      return log.completed ? 'done' : 'missed';\n    }\n    getWeeklyConsistency(habitId, endDate) {\n      let completed = 0;\n      let total = 0;\n      for (let i = 0; i < 7; i++) {\n        const date = new Date(endDate);\n        date.setDate(date.getDate() - i);\n        const dateStr = this.formatDate(date);\n        const log = this.logs().find(l => l.habitId === habitId && l.date === dateStr);\n        if (log?.completed) completed++;\n        total++;\n      }\n      return {\n        completed,\n        total\n      };\n    }\n    formatDate(date) {\n      return date.toISOString().split('T')[0];\n    }\n    static {\n      this.ɵfac = function HabitService_Factory(t) {\n        return new (t || HabitService)(i0.ɵɵinject(i1.FirebaseService));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: HabitService,\n        factory: HabitService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return HabitService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}