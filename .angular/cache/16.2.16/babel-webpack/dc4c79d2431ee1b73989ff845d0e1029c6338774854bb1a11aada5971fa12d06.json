{"ast":null,"code":"import { signal } from '@angular/core';\nimport { FirebaseService } from './firebase.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./firebase.service\";\nexport let HabitService = /*#__PURE__*/(() => {\n  class HabitService {\n    constructor(firebase) {\n      this.firebase = firebase;\n      this.habits = signal([]);\n      this.logs = signal([]);\n      this.allHabits = this.habits.asReadonly();\n      this.allLogs = this.logs.asReadonly();\n      this.firebase.onHabitsChange(habits => this.habits.set(habits));\n      this.firebase.onLogsChange(logs => this.logs.set(logs));\n    }\n    addHabit(habit) {\n      const updated = [...this.habits(), habit];\n      this.habits.set(updated);\n      this.firebase.saveHabits(updated);\n    }\n    logHabit(habitId, date, completed, note, milestoneCount) {\n      const logs = this.logs().filter(l => !(l.habitId === habitId && l.date === date));\n      const updated = [...logs, {\n        habitId,\n        date,\n        completed,\n        note,\n        milestoneCount\n      }];\n      this.logs.set(updated);\n      this.firebase.saveLogs(updated);\n    }\n    getHabitState(habitId, date) {\n      const log = this.logs().find(l => l.habitId === habitId && l.date === date);\n      if (!log) return 'pending';\n      return log.completed ? 'done' : 'missed';\n    }\n    getWeeklyConsistency(habitId, endDate) {\n      let completed = 0;\n      let total = 0;\n      for (let i = 0; i < 7; i++) {\n        const date = new Date(endDate);\n        date.setDate(date.getDate() - i);\n        const dateStr = this.formatDate(date);\n        const log = this.logs().find(l => l.habitId === habitId && l.date === dateStr);\n        if (log?.completed) completed++;\n        total++;\n      }\n      return {\n        completed,\n        total\n      };\n    }\n    formatDate(date) {\n      return date.toISOString().split('T')[0];\n    }\n    static {\n      this.ɵfac = function HabitService_Factory(t) {\n        return new (t || HabitService)(i0.ɵɵinject(i1.FirebaseService));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: HabitService,\n        factory: HabitService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return HabitService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}